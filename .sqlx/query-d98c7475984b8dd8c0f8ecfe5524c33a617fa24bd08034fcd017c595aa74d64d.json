{
  "db_name": "PostgreSQL",
  "query": "\n        WITH task AS (\n            SELECT run_id\n            FROM kagzi.workflow_runs\n            WHERE namespace = $1 \n              AND task_queue = $2\n              AND status IN ('PENDING', 'SLEEPING', 'RUNNING')\n              AND available_at <= NOW()\n              AND (array_length($3::TEXT[], 1) IS NULL \n                   OR array_length($3::TEXT[], 1) = 0 \n                   OR workflow_type = ANY($3))\n            ORDER BY available_at ASC\n            LIMIT 1\n            FOR UPDATE SKIP LOCKED\n        )\n        UPDATE kagzi.workflow_runs w\n        SET status = 'RUNNING',\n            locked_by = $4,\n            available_at = NOW() + ($5 * interval '1 second'),\n            started_at = COALESCE(started_at, NOW()),\n            attempts = attempts + 1\n        FROM task\n        WHERE w.run_id = task.run_id\n        RETURNING w.run_id,\n                  w.workflow_type,\n                  (SELECT input FROM kagzi.workflow_payloads p WHERE p.run_id = w.run_id) as \"input!\",\n                  w.locked_by\n        ",
  "describe": {
    "columns": [
      {
        "ordinal": 0,
        "name": "run_id",
        "type_info": "Uuid"
      },
      {
        "ordinal": 1,
        "name": "workflow_type",
        "type_info": "Text"
      },
      {
        "ordinal": 2,
        "name": "input!",
        "type_info": "Bytea"
      },
      {
        "ordinal": 3,
        "name": "locked_by",
        "type_info": "Text"
      }
    ],
    "parameters": {
      "Left": [
        "Text",
        "Text",
        "TextArray",
        "Text",
        "Float8"
      ]
    },
    "nullable": [
      false,
      false,
      null,
      true
    ]
  },
  "hash": "d98c7475984b8dd8c0f8ecfe5524c33a617fa24bd08034fcd017c595aa74d64d"
}
